$,=$";%G=(-1=>[1,2,1],1=>[-1,-2,-1]);$V[$_+1]=<>for@N=(-1..1);($X,$Y)=split/\s+/,$V[1];$/=$\;@A=split/\s+/,<>;for$i(1..$X-1){for$j(1..$Y-1){for$k(@N){$x+=($a=$A[($j+$k)*$X+$i+$_])*$G{$_}[$k],$y+=$a*-$G{$k}[$_]for@N}$o[$j][$i]=sqrt $x**2+$y**2;$x=$y=0}}for(@o){$m=$_>$m?$m:$_,$M=$_<$M?$M:$_ for@$_}print@V;print map{int(($_-$m)*255/$M)}@$_,"
"for@o;
